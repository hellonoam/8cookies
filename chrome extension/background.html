<script src="jQuery.js"></script>
<script type="text/javascript">
	chrome.extension.onRequest.addListener(
	function(request, sender, sendResponse) {
	    console.log("received message " + request.type);
		if (request.type == "send")
			sendData();
		else
			receiveData();
	    sendResponse({});
	});

	function sendData(){
		console.log("in sendData");
		var cookies;
		chrome.cookies.getAll({}, function(data) { cookies = data; });
		console.log("cookies:" + cookies.length);
		$.ajax({
			//since the server receives the data
			url: "http://localhost/bfc/ReceiveData",
			data: cookies,
			success: function(data) {
				console.log("data from server: " + data);
			}
		});
	}

	function receiveData(){
		console.log("in receiveData");
		var cookies;
		$.ajax({
			//since the server sends the data
			url: "http://localhost/bfc/SendData",
			success: function(data) {
				console.log("data from server: " + data);
				// for (int i=0; i<data.length; i++)
				// chrome.cookies.set(data[i]);
			}
		});
	}
</script>